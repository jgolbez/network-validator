tests:
  # ============================================================================
  # STEP 1: Extract Desktop IPs from DHCP Binding
  # ============================================================================

  - name: "Extract Desktop-0 IP from DHCP"
    description: "Find desktop-0's DHCP-assigned IP by matching its MAC address"
    command: "show ip dhcp binding"
    match_type: "contains"
    expected: "0152.5400.0ee7.0e"
    extract_var: "desktop_0_ip"
    extract_pattern: '(\d+\.\d+\.\d+\.\d+)\s+0152\.5400\.0ee7\.0e'
    devices: ["CORE-SW1"]

  - name: "Extract Desktop-1 IP from DHCP"
    description: "Find desktop-1's DHCP-assigned IP by matching its MAC address"
    command: "show ip dhcp binding"
    match_type: "contains"
    expected: "0152.5400.c168.c3"
    extract_var: "desktop_1_ip"
    extract_pattern: '(\d+\.\d+\.\d+\.\d+)\s+0152\.5400\.c168\.c3'
    devices: ["CORE-SW1"]

  # ============================================================================
  # STEP 2: Verify DHCP is Working (Not Static IPs)
  # ============================================================================

  - name: "Desktop-0 uses DHCP"
    description: "Verify desktop-0 IP is from active DHCP lease, not static"
    command: "show ip dhcp binding"
    match_type: "regex"
    expected: '0152\.5400\.0ee7\.0e.*Automatic.*Active'
    devices: ["CORE-SW1"]

  - name: "Desktop-1 uses DHCP"
    description: "Verify desktop-1 IP is from active DHCP lease, not static"
    command: "show ip dhcp binding"
    match_type: "regex"
    expected: '0152\.5400\.c168\.c3.*Automatic.*Active'
    devices: ["CORE-SW1"]

  # ============================================================================
  # STEP 3: Verify No Access-Lists Block Desktop IPs
  # ============================================================================

  - name: "No ACL denies Desktop-0 IP"
    description: "Check that no access-list contains a deny for desktop-0"
    command: "show access-lists"
    match_type: "not_contains"
    expected: "deny.*{desktop_0_ip}"

  - name: "No ACL denies Desktop-1 IP"
    description: "Check that no access-list contains a deny for desktop-1"
    command: "show access-lists"
    match_type: "not_contains"
    expected: "deny.*{desktop_1_ip}"

  - name: "No Standard ACL denies Desktop-0"
    description: "Standard ACLs may just show 'deny 10.10.10.x' format"
    command: "show access-lists"
    match_type: "not_contains"
    expected: "deny   {desktop_0_ip}"

  - name: "No Standard ACL denies Desktop-1"
    description: "Standard ACLs may just show 'deny 10.10.10.x' format"
    command: "show access-lists"
    match_type: "not_contains"
    expected: "deny   {desktop_1_ip}"

  # ============================================================================
  # STEP 4: Connectivity Tests (Task Outcome Validation)
  # Note: This test will PASS before task completion (ping succeeds)
  # After task completion, it should FAIL (ping blocked by attendee's solution)
  # ============================================================================

  - name: "Desktop-1 can ping Desktop-0 (before task)"
    description: "Desktop-1 should be able to reach Desktop-0 before task completion"
    command: "ping -c 5 {desktop_0_ip}"
    match_type: "contains"
    expected: "5 packets received"
    devices: ["DESKTOP-1"]
